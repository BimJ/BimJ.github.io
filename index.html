<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Sparade scheman</title>
  <style>body{font-family:Arial,Helvetica,sans-serif;padding:20px}</style>
</head>
<body>
  <h1>Sparade scheman</h1>
  <div id="list">Laddar...</div>
  <script>
    async function loadList() {
      const el = document.getElementById('list');
      try {
        const res = await fetch('/api/list-schedules');
        const data = await res.json();
        if (!res.ok) throw new Error(data.error || 'Fel');
        if (!data.files || data.files.length === 0) {
          el.innerText = 'Inga sparade scheman';
          return;
        }
        const ul = document.createElement('ul');
        data.files.forEach(f => {
          const li = document.createElement('li');
          const a = document.createElement('a');
          // Link to raw file in repo via GitHub raw URL
          a.href = f.download_url || `/data/schedules/${f.name}`;
          a.textContent = f.name + (f.date ? ' (' + f.date + ')' : '');
          a.target = '_blank';
          li.appendChild(a);
          ul.appendChild(li);
        });
        el.innerHTML = '';
        el.appendChild(ul);
      } catch (err) {
        el.innerText = 'Fel: ' + err.message;
      }
    }
    loadList();
  </script>
</body>
</html>
