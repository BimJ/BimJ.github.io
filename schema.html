<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <title>Schema</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }

    h1 {
      text-align: center;
    }

    .date-wrapper {
      text-align: center;
      margin-top: 10px;
      margin-bottom: 20px;
    }

    .schema-wrapper {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .schema-wrapper table {
      width: 48%;
    }

    table {
      border-collapse: collapse;
      table-layout: fixed;
    }

    th, td {
      border: 1px solid #ccc;
      text-align: center;
      padding: 5px;
      vertical-align: middle;
    }

    th {
      background-color: #1e88e5;
      color: white;
      height: 120px;
    }

    td:first-child {
      width: 80px;
      font-weight: bold;
    }

    .chatt1, .chatt2 { background-color: #fdd835; color: black; }
    .telefon1, .telefon2 { background-color: #43a047; color: white; }
    .admin, .meta { background-color: #1e88e5; color: white; }
    .lunch { background-color: #ffe0b2; color: black; }
    .semester { background-color: #ff9800; color: black; }
    .möte { background-color: #f44336; color: white; }
    .företag { background-color: #90caf9; color: white; }
    .sjuk, .vab { background-color: #ef9a9a; color: black; }
    .vägg { background-color: #9e9e9e; color: white; }

    select, input[type="text"], input[type="date"] {
      width: 100%;
      padding: 5px;
      font-size: 14px;
      box-sizing: border-box;
      margin-bottom: 4px;
    }

    .date-input {
      width: 150px;
    }

    .name-label {
      font-weight: bold;
      display: block;
      margin-top: 4px;
    }
  </style>
</head>
<body>
  <h1>Schema</h1>

  <div class="date-wrapper">
    <label for="date">Datum:</label>
    <input type="date" id="date" class="date-input" />
  </div>

  <div class="schema-wrapper">
    <table id="schedule1"></table>
    <table id="schedule2"></table>
  </div>

  <div id="citat" style="margin-top: 50px; font-style: italic; text-align: center; font-size: 18px; color: #555;">
    Laddar roligt citat...
  </div>

  <script>
    const namesGroup1 = ["Bim", "Rasmus", "Oliver", "Dennis", "Hampus", "Emil", "Kungens Kurva"];
    const namesGroup2 = ["Jennifer", "Huy", "Melanie", "Jocke", "Kim"];

    const tasks = [
      { label: "", icon: "" },
      { label: "Chatt 1", icon: "💬1️⃣" },
      { label: "Chatt 2", icon: "💬2️⃣" },
      { label: "Telefon 1", icon: "📞1️⃣" },
      { label: "Telefon 2", icon: "📞2️⃣" },
      { label: "Admin", icon: "🗂️" },
      { label: "Lunch", icon: "🍽️" },
      { label: "Meta & Trust", icon: "🛡️" },
      { label: "Möte", icon: "🗓️" },
      { label: "Admin-Företag", icon: "🏢" },
      { label: "Semester", icon: "🌻" },
      { label: "Vab", icon: "👶" },
      { label: "Sjuk", icon: "🤒" }
    ];

    const colors = {
      "Chatt 1": "chatt1",
      "Chatt 2": "chatt2",
      "Telefon 1": "telefon1",
      "Telefon 2": "telefon2",
      "Admin": "admin",
      "Lunch": "lunch",
      "Meta & Trust": "meta",
      "Admin-Företag": "företag",
      "Semester": "semester",
      "Möte": "möte",
      "Vab": "vab",
      "Sjuk": "sjuk",
      "Vägg": "vägg"
    };

    function skapaSchema(tabellId, namnLista, rubrik) {
      const table = document.getElementById(tabellId);
      const thead = document.createElement("thead");
      const headerRow = document.createElement("tr");

      const timeHeader = document.createElement("th");
      timeHeader.innerHTML = `<strong>${rubrik}</strong><br/>Tid`;
      headerRow.appendChild(timeHeader);

      namnLista.forEach((namn, index) => {
        const th = document.createElement("th");
        th.innerHTML = `
          <input type="text" placeholder="Kommentar..." />
          <select onchange="updateNameLabel(this)">
            <option value="">Välj namn</option>
            ${namnLista.map(n => `<option value="${n}">${n}</option>`).join('')}
          </select>
          <span class="name-label">Ingen vald</span>
          <select onchange="fillColumn(this, ${index + 1}, '${tabellId}')">
            <option value=""> </option>
            <option value="Semester">🌻 Semester</option>
            <option value="Vab">👶 Vab</option>
            <option value="Sjuk">🤒 Sjuk</option>
            <option value="Vägg">🧱 Vägg</option>
          </select>
        `;
        headerRow.appendChild(th);
      });

      thead.appendChild(headerRow);
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      for (let hour = 8; hour < 18; hour++) {
        const row = document.createElement("tr");
        const timeCell = document.createElement("td");
        timeCell.textContent = `${hour.toString().padStart(2, '0')}-${(hour + 1).toString().padStart(2, '0')}`;
        row.appendChild(timeCell);

        for (let i = 0; i < namnLista.length; i++) {
          const cell = document.createElement("td");
          const select = document.createElement("select");

          tasks.forEach(task => {
            const option = document.createElement("option");
            option.value = task.label;
            option.textContent = task.icon + " " + task.label;
            select.appendChild(option);
          });

          select.addEventListener("change", () => {
            select.className = colors[select.value] || "";
          });

          cell.appendChild(select);
          row.appendChild(cell);
        }

        tbody.appendChild(row);
      }

      table.appendChild(tbody);
    }

    function fillColumn(dropdown, colIndex, tabellId) {
      const table = document.getElementById(tabellId);
      const tbody = table.querySelector("tbody");
      const value = dropdown.value;
      const selects = tbody.querySelectorAll(`tr td:nth-child(${colIndex + 1}) select`);
      selects.forEach(select => {
        select.value = value;
        select.className = colors[value] || "";

        if (value === "Vägg") {
          select.parentElement.className = "vägg";
        } else {
          select.parentElement.className = "";
        }
      });
    }

    function updateNameLabel(select) {
      const label = select.parentElement.querySelector(".name-label");
      label.textContent = select.value || "Ingen vald";
    }

    skapaSchema("schedule1", namesGroup1, "KS-SE");
    skapaSchema("schedule2", namesGroup2, "AV-C");

    const citatUrl = "https://raw.githubusercontent.com/BimJ/BimJ.github.io/refs/heads/main/roliga_citat.json";
    let citatLista = [];

    function hämtaCitat() {
      fetch(citatUrl)
        .then(response => {
          if (!response.ok) throw new Error("Nätverksfel");
          return response.json();
        })
        .then(data => {
          citatLista = data;
          visaNyttCitat();
        })
        .catch(error => {
          console.error("Kunde inte hämta citat:", error);
          document.getElementById("citat").textContent = "Kunde inte ladda citat.";
        });
    }

    function visaNyttCitat() {
      if (citatLista.length > 0) {
        const slumpCitat = citatLista[Math.floor(Math.random() * citatLista.length)];
        document.getElementById("citat").textContent = `"${slumpCitat}"`;
      }
    }

    hämtaCitat();
  </script>
</body>
</html>
